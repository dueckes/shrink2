<% li_for(folder, :style => element_style(:hidden => hidden)) do -%>
  <div id="<%= dom_id(folder) %>_header" class="header highlight_controls_area">
    <div id="<%= dom_id(folder) %>_name">
      <%= render :partial => "folders/show_name", :locals => { :folder => folder } %>
    </div>
    <div class="highlight_controls">
      <%= link_to "^", "#", { :id => dom_id(folder, :expand_collapse_link), :class => "folder_expand_collapse_link", :title => "Expand" } %>
      <%= link_to_remote "+", { :url => { :controller => :folders, :action => :new, :parent_id => folder.id }, :method => :get }, { :id => dom_id(folder, :add_link), :title => "Add Sub-Folder" } %>
      <%= link_to_remote "X", { :confirm => "Are you sure you want to delete this folder?", :url => folder_path(folder), :method => :delete }, { :id => dom_id(folder, :delete_link), :title => "Delete" } %>
    </div>
  </div>
  <% expanded = !feature || folder.child_in_tree_path_until?(feature.folder) -%>
  <%= render :partial => "folders/list", :locals => { :folder => folder, :feature => feature, :expanded => expanded } %>
<% end -%>
